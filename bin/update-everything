#!/bin/sh

set -o errexit
set -o nounset
set -o xtrace

sleep 33

cd ~/.dotfiles
git pull --rebase
git push origin main

# Homebrew
if hash brew 2>/dev/null; then
    brew update
    brew upgrade
    brew autoremove
    brew cleanup
fi

if [ -d /Applications/Chromium.app ]; then
    xattr -d -r com.apple.quarantine /Applications/Chromium.app
fi

# gem
if hash gem 2>/dev/null; then
    gem update
fi

# docker
if hash docker 2>/dev/null; then
    if docker info; then
        docker system prune --filter "until=240h" --force
        docker volume prune --force
    fi
fi

if hash direnv 2>/dev/null; then
    direnv prune
fi
